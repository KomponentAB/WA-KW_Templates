{"version":3,"file":"winterevent-main-6ce9496a.js","sources":["../../src/winterevent-main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\nimport { bootstrapExtra } from \"@workadventure/scripting-api-extra\";\nimport { Subscription } from \"rxjs\";\n\nconsole.log('Script started successfully');\n\nlet currentPopup: any = undefined;\n\n// Waiting for the API to be ready\nWA.onInit().then(() => {\n    console.log('Scripting API ready');\n    console.log('Player tags: ', WA.player.tags);\n\n    WA.room.area.onEnter('clock').subscribe(() => {\n        const today = new Date();\n        const time = today.getHours() + \":\" + today.getMinutes();\n        currentPopup = WA.ui.openPopup(\"clockPopup\", \"It's \" + time, []);\n    });\n\n    WA.room.area.onLeave('clock').subscribe(closePopup);\n\n    // The line below bootstraps the Scripting API Extra library that adds a number of advanced properties/features to WorkAdventure\n    bootstrapExtra().then(() => {\n        console.log('Scripting API Extra ready');\n    }).catch(e => console.error(e));\n    WA.onInit().then(() => {\n    WA.room.area.onEnter('inside').subscribe(() => {\n        WA.room.hideLayer('hide/inside');\n        WA.room.showLayer('hide/outside');\n    });\n\n    WA.room.area.onEnter('outside').subscribe(() => {\n        WA.room.hideLayer('hide/outside');\n        WA.room.showLayer('hide/inside');\n    });\n    }).catch(e => console.error(e));\n}).catch(e => console.error(e));\n\nfunction closePopup() {\n    if (currentPopup !== undefined) {\n        currentPopup.close();\n        currentPopup = undefined;\n    }\n}\nWA.onInit()\n  .then(() => {\n    const startIceSkating = () => {\n      let isMoving = false;\n      return WA.player.onPlayerMove(async ({ moving }) => {\n        if (!moving || isMoving) return;\n        isMoving = true;\n        WA.controls.disablePlayerControls();\n        \n        // Define the ice area coordinate ranges\n        const minX = 1200;\n        const maxX = 1800;\n        const minY = 800;\n        const maxY = 1200;\n\n        // Generate random coordinates within the ice area\n        const randomX = Math.random() * (maxX - minX) + minX;\n        const randomY = Math.random() * (maxY - minY) + minY;\n\n        console.log(`Moving to random position: x=${randomX}, y=${randomY}`);\n        \n        WA.player.moveTo(randomX, randomY, 30).then(({ }) => {\n          WA.controls.restorePlayerControls();\n          isMoving = false;\n        });\n      });\n    };\n\n\n    let skatingSub: Subscription;\n\n    WA.room.area.onEnter(\"ice\").subscribe(() => {\n      console.log(\"enter\");\n      skatingSub = startIceSkating();\n    });\n\n    WA.room.area.onLeave(\"ice\").subscribe(() => {\n      console.log(\"leave\");\n      skatingSub.unsubscribe();\n    });\n  })\n  .catch((e) => console.error(e));\nexport {};"],"names":["currentPopup","today","time","closePopup","bootstrapExtra","e","startIceSkating","isMoving","moving","minX","maxX","minY","maxY","randomX","randomY","skatingSub"],"mappings":"uCAKA,QAAQ,IAAI,6BAA6B,EAEzC,IAAIA,EAGJ,GAAG,OAAA,EAAS,KAAK,IAAM,CACnB,QAAQ,IAAI,qBAAqB,EACjC,QAAQ,IAAI,gBAAiB,GAAG,OAAO,IAAI,EAE3C,GAAG,KAAK,KAAK,QAAQ,OAAO,EAAE,UAAU,IAAM,CACpC,MAAAC,MAAY,KACZC,EAAOD,EAAM,SAAA,EAAa,IAAMA,EAAM,aAC5CD,EAAe,GAAG,GAAG,UAAU,aAAc,QAAUE,EAAM,CAAA,CAAE,CAAA,CAClE,EAED,GAAG,KAAK,KAAK,QAAQ,OAAO,EAAE,UAAUC,CAAU,EAGnCC,EAAA,EAAE,KAAK,IAAM,CACxB,QAAQ,IAAI,2BAA2B,CAAA,CAC1C,EAAE,SAAW,QAAQ,MAAMC,CAAC,CAAC,EAC3B,GAAA,SAAS,KAAK,IAAM,CACvB,GAAG,KAAK,KAAK,QAAQ,QAAQ,EAAE,UAAU,IAAM,CACxC,GAAA,KAAK,UAAU,aAAa,EAC5B,GAAA,KAAK,UAAU,cAAc,CAAA,CACnC,EAED,GAAG,KAAK,KAAK,QAAQ,SAAS,EAAE,UAAU,IAAM,CACzC,GAAA,KAAK,UAAU,cAAc,EAC7B,GAAA,KAAK,UAAU,aAAa,CAAA,CAClC,CAAA,CACA,EAAE,SAAW,QAAQ,MAAMA,CAAC,CAAC,CAClC,CAAC,EAAE,MAAMA,GAAK,QAAQ,MAAMA,CAAC,CAAC,EAE9B,SAASF,GAAa,CACdH,IAAiB,SACjBA,EAAa,MAAM,EACJA,EAAA,OAEvB,CACA,GAAG,OAAA,EACA,KAAK,IAAM,CACV,MAAMM,EAAkB,IAAM,CAC5B,IAAIC,EAAW,GACf,OAAO,GAAG,OAAO,aAAa,MAAO,CAAE,OAAAC,KAAa,CAClD,GAAI,CAACA,GAAUD,EAAU,OACdA,EAAA,GACX,GAAG,SAAS,wBAGZ,MAAME,EAAO,KACPC,EAAO,KACPC,EAAO,IACPC,EAAO,KAGPC,EAAU,KAAK,OAAO,GAAKH,EAAOD,GAAQA,EAC1CK,EAAU,KAAK,OAAO,GAAKF,EAAOD,GAAQA,EAEhD,QAAQ,IAAI,gCAAgCE,CAAO,OAAOC,CAAO,EAAE,EAEhE,GAAA,OAAO,OAAOD,EAASC,EAAS,EAAE,EAAE,KAAK,CAAC,KAAQ,CACnD,GAAG,SAAS,wBACDP,EAAA,EAAA,CACZ,CAAA,CACF,CAAA,EAIC,IAAAQ,EAEJ,GAAG,KAAK,KAAK,QAAQ,KAAK,EAAE,UAAU,IAAM,CAC1C,QAAQ,IAAI,OAAO,EACnBA,EAAaT,EAAgB,CAAA,CAC9B,EAED,GAAG,KAAK,KAAK,QAAQ,KAAK,EAAE,UAAU,IAAM,CAC1C,QAAQ,IAAI,OAAO,EACnBS,EAAW,YAAY,CAAA,CACxB,CACH,CAAC,EACA,MAAOV,GAAM,QAAQ,MAAMA,CAAC,CAAC"}