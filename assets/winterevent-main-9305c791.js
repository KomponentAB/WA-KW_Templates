import{P as b,b as W}from"./init-45730ad6.js";import{c as T,m as y,p as S}from"./footstep-27b9ed04.js";const w=["Oh, you found the limited-edition whiskey for Uncle Bob! This will surely make the holidays... blurry.","Great job finding the karaoke machine! Aunt Susan's neighbors are going to *love* you for this.","Ah, the drum set for little Timmy! He'll be thrilled, but his parents might need earplugs. Or therapy.","You found the scented candles! Now Grandma can make her house smell like 37 types of lavender. Delightful!","Oh look, the VR headset for Dad! He might come back to reality around Easter.","Nice work finding the skateboard! Let’s hope Cousin Mike remembers he’s 42 now.","The box of chocolates! Mom’s secret stash of 'self-care' is back on track.","Ah, the pogo stick for Lucy! The floors might not survive, but she will have a blast!","You found the designer purse! Aunt Carol will look classy while she complains about her back pain.","The electric guitar for Alex! Time for some rock and roll... and some noise complaints.","You got the espresso machine! Let's prepare for sleepless nights and jittery mornings.","Perfect! The book of dad jokes. Prepare for the groans of an entire household.","Ah, the DIY craft set for your niece! Her parents are going to love the glitter... *everywhere*.","Great find! A gift card for a spa day. Too bad it doesn’t come with free babysitting.","You found the blender! Now Uncle Ted can make margaritas no one asked for.","The socks with wild patterns! Because nothing says 'fun' like hidden chaos in your shoes.","Oh look, a board game! Cue the family bonding and inevitable passive-aggressive arguments.","A fancy new watch for Grandpa! He still won't know how to set it, though.","Nice work! The wine set for Aunt Marie. Holiday survival kit: complete.","Ah, the vintage record player! Now Dad can lecture everyone about 'real music.'","You found the roller skates! Let’s hope Cousin Jenna’s knees are still insured.","The yoga mat for Aunt Linda! She'll meditate, stretch, and then complain about her hips.","A plush robe for Mom! Now she can *officially* lounge in style while ignoring everyone.","Oh, a sci-fi novel for Jeff! Prepare for hours of plot recaps you didn’t ask for.","The remote-controlled car! Now Dad has something else to crash into the furniture.","Great job! You found the jigsaw puzzle. Family time or family feud? Let’s find out!","Ah, the perfume set for Aunt Patty! She’ll love it, and so will everyone within a 10-foot radius.","The novelty mug! Because Dad really needed a cup that says, 'World's Okayest Dad.'","You found the fitness tracker! Let’s see how long until it's 'accidentally' left in a drawer.","The cookbook! Time for some experimental dishes... and a backup pizza delivery plan.","You found the snow globe! Now Aunt Betty can shake a winter wonderland without leaving the couch.","Ah, the cocktail shaker set! Uncle Joe’s about to rediscover the 'art' of mixing drinks—and disasters.","The hot sauce gift box! Someone’s taste buds are about to file for early retirement.","A set of bath bombs! Now your sister can feel like she’s relaxing in a fizzy rainbow... until the kids bang on the door.","You found the beard grooming kit! Time to turn Cousin Steve’s 'wild woodsman' look into 'confused hipster.'","Ah, the Bluetooth speaker! Get ready for holiday classics with a side of questionable volume control.","The yoga DVD set! Because nothing says relaxation like falling over during downward dog.","Oh, the retro video game console! Dad's about to show the kids how he 'used to dominate'... 30 years ago.","You found the astronomy kit! Now everyone gets to freeze outside while pretending to know constellations.","The pet sweater! Your cat's going to love you... or plot revenge in style.","Nice work! The personalized calendar. Grandma can now schedule *everyone’s* lives.","Ah, the noise-canceling headphones! Perfect for surviving family gatherings without starting a feud.","You found the fitness DVD! Cousin Mike will start tomorrow... or maybe next year.","The inflatable hot tub! Because what’s better than a lukewarm pool in the middle of winter?","Ah, the fancy teapot! Now Aunt Jane can pretend she’s hosting a royal tea party. Pinkies up!","The scented hand soap set! Because who doesn't need a bathroom that smells like 'Ocean Breeze with Vanilla Twilight'?","A magic kit for Billy! Let’s hope he learns to make his messes disappear.","You found the calendar full of motivational quotes! Perfect for making everyone feel vaguely guilty.","The electric massager! Because sometimes the holidays are a real pain in the neck.","The heated blanket! Now Grandma can roast herself like a marshmallow all winter long.","You got the fancy wine opener! Because struggling with corkscrews is *so* last year.","Ah, the adult coloring book! Stress relief meets the frustration of staying inside the lines.","You found the fishing gear! Dad will finally have another excuse to avoid chores.","The candle-making kit! Now your sister can create fire hazards in *any* scent.","The new drone! Prepare for 10 minutes of fun and 2 hours of finding where it crashed.","Oh, the DIY home-brew kit! Get ready for beer that *might* be drinkable... or not.","You found the gourmet popcorn set! Perfect for eating during movie night... or just because.","The karaoke microphone! Aunt Linda's going to belt out tunes like she's at Madison Square Garden.","Ah, the leather wallet! A classy way for Uncle Tom to carry around *just* coupons.","The luxury bathrobe! Mom's about to level up her lounging game to pro status.","You found the mystery puzzle! Grandma will enjoy piecing it together... until the dog eats a piece.","The karaoke microphone for Aunt Janet! Her *Broadway debut* is happening in the living room tonight.","The superhero cape for Timmy! He'll save the day... or at least attempt to jump off the couch.","Ah, the prank gift box! Dad's about to give a present that confuses everyone, including himself.","The glow-in-the-dark puzzle for Cousin Mark! Because who needs lights when frustration glows?","You found the digital photo frame! Perfect for Mom to display *way too many* vacation photos.","The retro record player for Uncle Dave! He'll tell everyone vinyl sounds better, and everyone will pretend to agree."];let g="https://admin.workadventu.re";function m(){const o=WA.player.userRoomToken;if(o===void 0)throw new Error("No userRoomToken found. The quests plugin can only work with WorkAdventure SAAS edition (at https://play.workadventu.re).");return o}async function x(o){const e=new URL(`/api/quests/${o}/leaderboard`,g);e.search=new URLSearchParams({room:WA.room.id}).toString();const t=await fetch(e,{method:"GET",headers:{Authorization:m()}});if(!t.ok)throw new Error(`An error occurred. HTTP Code: ${t.status} ${t.statusText}.`);return await t.json()}function P(o){const e=new URL(`/quests/${o}/leaderboard`,g);return e.search=new URLSearchParams({room:WA.room.id,token:m()}).toString(),e}async function A(o,e){if(!WA.player.isLogged)throw new Error("You must be logged to gain XP.");const t=new URL(`/api/quests/${o}/level-up`,g),a=await fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:m()},body:JSON.stringify({xp:e})});if(!a.ok)throw new Error(`An error occurred. HTTP Code: ${a.status} ${a.statusText}.`);const n=await a.json();return n.awardedBadges.length>0&&(async()=>{for(const s of n.awardedBadges)await M(o,s)})().catch(s=>{console.error(s)}),n}async function M(o,e){const t=new URL(`/quests/${o}/badge/${e}/congratulations`,g);t.search=new URLSearchParams({token:m()}).toString(),await WA.ui.website.open({url:t.toString(),position:{vertical:"middle",horizontal:"middle"},allowApi:!0,visible:!0,size:{width:"100%",height:"100%"}})}console.log("Script started successfully");WA.onInit().then(()=>{console.log("Scripting API ready"),console.log("Player tags: ",WA.player.tags),console.log("Properties loaded: ",b),console.log("Quests loaded: ",A),console.log("Leaderboard loaded: ",x),W().then(()=>{console.log("Scripting API Extra ready")}).catch(o=>console.error(o)),WA.onInit().then(()=>{WA.room.area.onEnter("inside").subscribe(()=>{WA.room.hideLayer("hide/inside"),WA.room.showLayer("hide/outside")}),WA.room.area.onEnter("outside").subscribe(()=>{WA.room.hideLayer("hide/outside"),WA.room.showLayer("hide/inside")})}).catch(o=>console.error(o))}).catch(o=>console.error(o));WA.onInit().then(()=>{const o=()=>{let e=!1;return WA.player.onPlayerMove(async({moving:t})=>{if(!t||e)return;e=!0,WA.controls.disablePlayerControls();const a=1200,n=1800,s=800,i=1200,c=Math.random()*(n-a)+a,l=Math.random()*(i-s)+s;console.log(`Moving to random position: x=${c}, y=${l}`),WA.player.moveTo(c,l,30).then(({})=>{WA.controls.restorePlayerControls(),e=!1})})};WA.onInit().then(()=>{let e;WA.room.area.onEnter("ice").subscribe(()=>{console.log("enter"),e=o()}),WA.room.area.onLeave("ice").subscribe(()=>{console.log("leave"),e.unsubscribe()})}).catch(e=>console.error(e))});WA.event.on("pong").subscribe(o=>{const e=o.data;console.log("Received placed gifts:",e),WA.room.setTiles(e),WA.state.saveVariable("placedGifts",e)});WA.event.on("foundGift").subscribe(async o=>{const{x:e,y:t}=o.data;console.log(`Gift found at (${e}, ${t})`),WA.room.setTiles([{x:e,y:t,tile:null,layer:"gifts"}]);const n=(await WA.state.loadVariable("placedGifts")).filter(s=>s.x!==e||s.y!==t);WA.state.saveVariable("placedGifts",n)});WA.room.onEnterLayer("gifts").subscribe(async()=>{console.log("Player entered gifts layer");const{x:o,y:e}=await WA.player.getPosition();console.log("Player position in pixels:",{x:o,y:e});const t=Math.floor(o/32),a=Math.floor(e/32);if(!(await WA.state.loadVariable("placedGifts")).some(d=>d.x===t&&d.y===a)){console.log("No gift at this position");return}const i=Math.floor(Math.random()*w.length),c=w.splice(i,1)[0],l=WA.sound.loadSound("./pickup3.wav"),h={volume:.5,loop:!1,rate:1,detune:1,delay:0,seek:0,mute:!1};l.play(h),WA.event.broadcast("foundGift",{x:t,y:a}),WA.chat.sendChatMessage(c,"Santa"),await A("GIFTS",1)});WA.onInit().then(async()=>{const o=await WA.state.loadVariable("placedGifts");o&&o.length>0&&WA.room.setTiles(o)});WA.onInit().then(async()=>{WA.player.onPlayerMove(async({x:o,y:e,moving:t})=>{var n,s,i;const a=await T({x:o,y:e});return console.log(a),a?!t&&!a?(s=y)==null?void 0:s.stop():((i=y)==null||i.stop(),S(a)):(n=y)==null?void 0:n.stop()})});WA.onInit().then(()=>{if(WA.player.tags.includes("Santa")){WA.event.on("ping").subscribe(async e=>{if(e.data==="start"){console.log("Starting gift population...");const t=await o();WA.event.broadcast("pong",t)}}),WA.event.broadcast("ping","start");async function o(){const e=await WA.room.getTiledMap();console.log("Room Height: ",e.height),console.log("Room Width: ",e.width);const a=new b(e.properties).getString("collisionLayerName")||"collisions",n=e.layers.find(r=>r.name===a);if(!n||n.type!=="tilelayer")return console.error("Collision layer not found or is not a tile layer"),[];const s=n.data,i=n.width,c=n.height,l=[];for(let r=0;r<c;r++)for(let f=0;f<i;f++){const p=r*i+f;s[p]===0&&l.push({x:f,y:r})}const h=8,d=50,u=[];for(let r=0;r<d;r++){const f=Math.floor(Math.random()*l.length),{x:p,y:k}=l.splice(f,1)[0],v=`gift_${Math.floor(Math.random()*h)+1}`;u.push({x:p,y:k,tile:v,layer:"gifts"})}return console.log("Gifts placed:",u),u}}});WA.onInit().then(()=>{WA.room.area.onEnter("santasCrashSite").subscribe(()=>{let o;if(WA.player.tags.includes("member")){const e=P("GIFTS");console.log("Leaderboard URL: ",e.toString()),o=e.toString()}else o="https://cocreation.world/pub/xmas24";WA.ui.modal.openModal({title:"GiftsQuest Leaderboard",src:o,position:"left",allowApi:!1,allow:""},()=>{})})});WA.onInit().then(async()=>{if(WA.player.tags.includes("Santa")){WA.event.broadcast("ping","start");const o=await WA.player.getPosition(),{x:e,y:t}=o;let a=null;const n=()=>{const c=Math.max(e-32,0),l=e+32,h=Math.max(t-32,0),d=t+32,u=Math.random()*(l-c)+c,r=Math.random()*(d-h)+h;console.log(`Santa moving to random position: x=${u}, y=${r}`),WA.player.moveTo(u,r,1)},s=()=>{a||(a=setInterval(n,Math.random()*5e3+2e3))},i=()=>{a&&(clearInterval(a),a=null)};WA.room.area.onEnter("santasCrashSite").subscribe(()=>{console.log("Player entered santasCrashSite, stopping movement"),i()}),WA.room.area.onLeave("santasCrashSite").subscribe(()=>{console.log("Player left santasCrashSite, starting movement"),s()})}});
//# sourceMappingURL=winterevent-main-9305c791.js.map
