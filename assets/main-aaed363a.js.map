{"version":3,"file":"main-aaed363a.js","sources":["../../src/main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\nconsole.log('Script started successfully');\n\ntype FloorName = 'top' | 'middle' | 'bottom';\nconst LAYERS = {\n    'top': [\n        'top/fg-lights',\n        'top/fg-anim',\n        'top/fg',\n        'top/bg-anim',\n        'top/bg',\n        'collisions/top'\n    ],\n    'middle': [\n        'middle/fg',\n        'middle/bg-anim',\n        'middle/bg',\n        'collisions/middle'\n    ],\n    'bottom': [\n        'bottom/fg-anim',\n        'bottom/fg',\n        'bottom/bg-anim',\n        'bottom/bg',\n        'collisions/bottom'\n    ]\n\n}\nlet currentFloor: FloorName;\nconst FLOOR_TOP = 'top'\nconst FLOOR_MIDDLE = 'middle'\nconst FLOOR_BOTTOM = 'bottom'\n\n// Waiting for the API to be ready\nWA.onInit().then(() => {\n    console.log('Scripting API ready');\n    console.log('Player tags: ',WA.player.tags);\n\n    // Player is at the top floor by default\n    currentFloor = FLOOR_TOP\n    showTopFloor()\n\n    // Event listeners for stairs\n    // From bottom to middle\n    WA.room.area.onEnter('stairBottomToMiddle').subscribe(() => {\n        transitionToFloor(FLOOR_BOTTOM, FLOOR_MIDDLE)\n    });\n\n    // From middle to bottom\n    WA.room.area.onEnter('stairMiddleToBottom').subscribe(() => {\n        transitionToFloor(FLOOR_MIDDLE, FLOOR_BOTTOM)\n    });\n\n    // From middle to top\n    WA.room.area.onEnter('stairMiddleToTopLeft').subscribe(() => {\n        transitionToFloor(FLOOR_MIDDLE, FLOOR_TOP)\n    });\n    WA.room.area.onEnter('stairMiddleToTopRight').subscribe(() => {\n        transitionToFloor(FLOOR_MIDDLE, FLOOR_TOP)\n    });\n\n    // From top to middle\n    WA.room.area.onEnter('stairTopToMiddleLeft').subscribe(() => {\n        transitionToFloor(FLOOR_TOP, FLOOR_MIDDLE)\n    });\n    WA.room.area.onEnter('stairTopToMiddleRight').subscribe(() => {\n        transitionToFloor(FLOOR_TOP, FLOOR_MIDDLE)\n    });\n}).catch(e => console.error(e));\n\nfunction transitionToFloor(fromFloor: FloorName, toFloor: FloorName): void {\n    if (currentFloor === fromFloor) {\n        // Hide layers of the current floor\n        LAYERS[fromFloor].forEach(layer => {\n            WA.room.hideLayer(layer);\n        });\n\n        // Show layers of the new floor\n        LAYERS[toFloor].forEach(layer => {\n            WA.room.showLayer(layer);\n        });\n\n        // Update the current floor after 1 sec because otherwise it triggers the next room area immediatly\n        setTimeout(() => {\n            currentFloor = toFloor;\n        }, 1000)\n    }\n}\n\nfunction showTopFloor() {\n    // Hide middle and bottom layers\n    LAYERS.middle.forEach(layer => {\n        WA.room.hideLayer(layer);\n    });\n    LAYERS.bottom.forEach(layer => {\n        WA.room.hideLayer(layer);\n    });\n\n    // Show top layers\n    LAYERS.top.forEach(layer => {\n        WA.room.showLayer(layer);\n    });\n}\n\nexport {};\n"],"names":["LAYERS","currentFloor","FLOOR_TOP","FLOOR_MIDDLE","FLOOR_BOTTOM","showTopFloor","transitionToFloor","e","fromFloor","toFloor","layer"],"mappings":"AAEA,QAAQ,IAAI,6BAA6B,EAGzC,MAAMA,EAAS,CACX,IAAO,CACH,gBACA,cACA,SACA,cACA,SACA,gBACJ,EACA,OAAU,CACN,YACA,iBACA,YACA,mBACJ,EACA,OAAU,CACN,iBACA,YACA,iBACA,YACA,mBACJ,CAEJ,EACA,IAAIC,EACJ,MAAMC,EAAY,MACZC,EAAe,SACfC,EAAe,SAGrB,GAAG,OAAA,EAAS,KAAK,IAAM,CACnB,QAAQ,IAAI,qBAAqB,EACjC,QAAQ,IAAI,gBAAgB,GAAG,OAAO,IAAI,EAG3BH,EAAAC,EACFG,IAIb,GAAG,KAAK,KAAK,QAAQ,qBAAqB,EAAE,UAAU,IAAM,CACxDC,EAAkBF,EAAcD,CAAY,CAAA,CAC/C,EAGD,GAAG,KAAK,KAAK,QAAQ,qBAAqB,EAAE,UAAU,IAAM,CACxDG,EAAkBH,EAAcC,CAAY,CAAA,CAC/C,EAGD,GAAG,KAAK,KAAK,QAAQ,sBAAsB,EAAE,UAAU,IAAM,CACzDE,EAAkBH,EAAcD,CAAS,CAAA,CAC5C,EACD,GAAG,KAAK,KAAK,QAAQ,uBAAuB,EAAE,UAAU,IAAM,CAC1DI,EAAkBH,EAAcD,CAAS,CAAA,CAC5C,EAGD,GAAG,KAAK,KAAK,QAAQ,sBAAsB,EAAE,UAAU,IAAM,CACzDI,EAAkBJ,EAAWC,CAAY,CAAA,CAC5C,EACD,GAAG,KAAK,KAAK,QAAQ,uBAAuB,EAAE,UAAU,IAAM,CAC1DG,EAAkBJ,EAAWC,CAAY,CAAA,CAC5C,CACL,CAAC,EAAE,MAAMI,GAAK,QAAQ,MAAMA,CAAC,CAAC,EAE9B,SAASD,EAAkBE,EAAsBC,EAA0B,CACnER,IAAiBO,IAEVR,EAAAQ,CAAS,EAAE,QAAiBE,GAAA,CAC5B,GAAA,KAAK,UAAUA,CAAK,CAAA,CAC1B,EAGMV,EAAAS,CAAO,EAAE,QAAiBC,GAAA,CAC1B,GAAA,KAAK,UAAUA,CAAK,CAAA,CAC1B,EAGD,WAAW,IAAM,CACET,EAAAQ,GAChB,GAAI,EAEf,CAEA,SAASJ,GAAe,CAEbL,EAAA,OAAO,QAAiBU,GAAA,CACxB,GAAA,KAAK,UAAUA,CAAK,CAAA,CAC1B,EACMV,EAAA,OAAO,QAAiBU,GAAA,CACxB,GAAA,KAAK,UAAUA,CAAK,CAAA,CAC1B,EAGMV,EAAA,IAAI,QAAiBU,GAAA,CACrB,GAAA,KAAK,UAAUA,CAAK,CAAA,CAC1B,CACL"}