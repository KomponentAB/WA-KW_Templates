import{g as A}from"./init-8185d94b.js";var a=(o=>(o.wood="wood",o.forest="forest",o.snow="snow",o.marble="marble",o.stone="stone",o.mud="mud",o.path="path",o.water="water",o.sand="sand",o.ice="ice",o))(a||{});const w={[a.wood]:["wood_01_a.wav","wood_01_b.wav","wood_01_c.wav","wood_01_d.wav"],[a.forest]:["forest_01_a.wav","forest_01_b.wav","forest_01_c.wav","forest_01_d.wav","forest_01_e.wav"],[a.snow]:["snow_01_a.wav","snow_01_b.wav","snow_01_c.wav","snow_01_d.wav"],[a.marble]:["marble_01_a.wav","marble_01_b.wav","marble_01_c.wav","marble_01_d.wav"],[a.mud]:["mud_01_a.wav","mud_01_b.wav","mud_01_c.wav","mud_01_d.wav"],[a.path]:["path_01_a.wav","path_01_b.wav","path_01_c.wav","path_01_d.wav","path_01_e.wav"],[a.stone]:["stone_01_a.wav","stone_01_b.wav","stone_01_c.wav","stone_01_d.wav","stone_01_e.wav"],[a.water]:["water_01_a.wav","water_01_b.wav"],[a.sand]:["sand_01_a.wav","sand_01_b.wav","sand_01_c.wav"],[a.ice]:["ice_01.wav","ice_02.wav","ice_03.wav","ice_04.wav"]},x={volume:.05,loop:!1,rate:1.5,detune:1,delay:0,seek:0,mute:!1};let f,m=[];function E(o){if(!w[o])return;const e=Math.floor(Math.random()*w[o].length);f=WA.sound.loadSound(`/stepFX/sounds/${w[o][e]}`),f.play(x)}async function k(){var o;try{const e=await A(),s=[];for(const u of e.values())if(u.type==="objectgroup"){for(const t of u.objects)if(t.properties&&t.properties.some(i=>i.name==="stepSound"&&i.value===!0)){const i=(o=t.properties.find(_=>_.name==="material"))==null?void 0:o.value;w[i]&&s.push({name:t.name,x:t.x,y:t.y,width:t.width,height:t.height,material:i})}}return console.log("Found step sound areas:",s),s}catch(e){return console.error("Error while getting step sound areas:",e),[]}}function W(o,e){return o.x>=e.x&&o.x<=e.x+e.width&&o.y>=e.y&&o.y<=e.y+e.height}async function I(o){try{for(const e of m)if(W(o,e))return e.material;return null}catch(e){return console.error("Error while checking player material:",e),null}}WA.onInit().then(async()=>{m=await k()});const v={animationLayer:"anim",fireworkDuration:1e3*1.4};var h=(o=>(o.RED="red",o.PINK="pink",o.GREEN="green",o.YELLOW="yellow",o.PURPLE="purple",o.BLUE="blue",o))(h||{});function L(){y(),S(),console.log("ðŸŽ† Fireworks initialized successfully")}function y(){const o="firework-btn";WA.ui.actionBar.addButton({id:o,label:"Fireworks! ðŸŽ†",callback:()=>{WA.ui.actionBar.removeButton(o),p().then(e=>{WA.event.broadcast("firework",{playerId:WA.player.id,x:e.x,y:e.y,color:e.color})}).finally(()=>y())}})}async function p(o){const e=o||await t(),s=await _(e);return WA.room.setTiles(s),u("./sounds/firework_single.mp3"),new Promise((n,r)=>{setTimeout(()=>{try{WA.room.setTiles([...s.map(c=>({...c,tile:null}))]),n(e)}catch(c){console.error("Failed to trigger firework",c),r(c)}},v.fireworkDuration)});function u(n){const r=WA.sound.loadSound(n),c=Math.random()>=.5,d=Math.round(Math.random()*850),l={loop:!1,detune:c?d:-d};r.play(l)}async function t(){const{x:n,y:r}=await WA.player.getPosition();return{x:n,y:r,color:i()}}function i(){const n=Object.values(h);return n[Math.floor(Math.random()*n.length)]}async function _(n){const r={x:Math.floor(n.x/32),y:Math.floor(n.y/32),layer:v.animationLayer,tile:null};return new Array(9).fill(null).map((d,l)=>{const b=l%3-1,g=Math.floor(l/3)-1;return{...r,x:r.x+b,y:r.y+g,tile:`${n.color}_${l+1}`}})}}function S(){WA.event.on("firework").subscribe(o=>{const{playerId:e,x:s,y:u,color:t}=o.data;e!==WA.player.id&&p({x:s,y:u,color:t})})}export{I as c,f as m,E as p,L as s};
//# sourceMappingURL=fireworks-9f30f6cf.js.map
