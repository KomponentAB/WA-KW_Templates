{"version":3,"file":"smallOffice-main-0dfdd8c5.js","sources":["../../src/smallOffice-main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n/// <reference types=\"vite/client\" />\n\nimport { bootstrapExtra } from \"@workadventure/scripting-api-extra\";\nimport { checkPlayerMaterial, mySound, playRandomSound } from \"./footstep\";\nimport {ActionMessage} from \"@workadventure/iframe-api-typings\";\n\nconsole.log('Script started successfully');\n\nlet currentPopup: any = undefined;\n\n// Waiting for the API to be ready\nWA.onInit().then(() => {\n    console.log('Scripting API ready');\n    console.log('Player tags: ',WA.player.tags)\n\n    WA.room.area.onEnter('clock').subscribe(() => {\n        const today = new Date();\n        const time = today.getHours() + \":\" + today.getMinutes();\n        currentPopup = WA.ui.openPopup(\"clockPopup\", \"It's \" + time, []);\n    })\n\n    WA.room.area.onLeave('clock').subscribe(closePopup)\n\n    // The line below bootstraps the Scripting API Extra library that adds a number of advanced properties/features to WorkAdventure\n    bootstrapExtra().then(() => {\n        console.log('Scripting API Extra ready');\n    }).catch(e => console.error(e));\n\n}).catch(e => console.error(e));\n\nfunction closePopup(){\n    if (currentPopup !== undefined) {\n        currentPopup.close();\n        currentPopup = undefined;\n    }\n}\n\n// Get an existing website object where 'my_website' is the name of the object (on any layer object of the map)\nasync function updateTitle() {\n    var text: string = WA.state.textVariable as string;\n    console.log('Text is configured as ' + text);\n    var color: string = WA.state.colorVariable as string;\n    console.log('Color is configured as ' + color);\n    var newTitle = `https://iw6tkif7th7yp5ax2ufzkl3kce0bcuys.lambda-url.us-east-1.on.aws/?text=${encodeURIComponent(text)}&imageType=caption&width=88&height=24&color=${encodeURIComponent(color)}`;\n    console.log('New img-url of title is ' + newTitle);\n    const website = await WA.room.website.get(\"titleScreen\");\n    website.url = newTitle;\n    website.visible = true;\n    console.log(`Title has been changed to ${website.url}`);\n};\nWA.onInit().then(() => { updateTitle(); });\n\n// Listen for changes to the textVariable\nWA.state.onVariableChange('textVariable').subscribe(() => {\n    console.log(`Text variable changed`);\n    updateTitle();\n});\n\n// Listen for changes to the colorVariable\nWA.state.onVariableChange('colorVariable').subscribe(() => {\n    console.log(`Color variable changed`);\n    updateTitle();\n});\nWA.onInit().then(() => {\nWA.room.area.onEnter('hideRoofZone').subscribe(() => {\n    WA.room.hideLayer('above-roof/above-roof1')\n    WA.room.hideLayer('above-roof/above-roof2')\n    WA.room.hideLayer('above-roof/above-roof3');\n})\nWA.room.area.onLeave('hideRoofZone').subscribe(() => {\n    WA.room.showLayer('above-roof/above-roof1')\n    WA.room.showLayer('above-roof/above-roof2')\n    WA.room.showLayer('above-roof/above-roof3');\n})})\n\n//alternative way to hide the roof\n\nWA.onInit().then(() => {\n    WA.room.onEnterLayer('hideRoof').subscribe(() => {\n        WA.room.hideLayer('above-roof/above-roof1')\n        WA.room.hideLayer('above-roof/above-roof2')\n        WA.room.hideLayer('above-roof/above-roof3');\n    })\n    WA.room.onLeaveLayer('hideRoof').subscribe(() => {\n        WA.room.showLayer('above-roof/above-roof1')\n        WA.room.showLayer('above-roof/above-roof2')\n        WA.room.showLayer('above-roof/above-roof3');\n    })})\n    \nWA.onInit().then(async () => {\n    WA.player.onPlayerMove(async ({ x, y, moving }) => {\n      const material = await checkPlayerMaterial({ x, y });\n      console.log(material);\n  \n      if (!material) {\n        return mySound?.stop();\n      }\n  \n      if (!moving && !material) {\n        return mySound?.stop();\n      } else {\n        mySound?.stop();\n        return playRandomSound(material);\n      }\n    });\n  });\n\n  \n// Waiting for the API to be ready\nWA.onInit().then(() => {\n    let actionMessage: ActionMessage | undefined;\n    let name: string;\n\n    // When someone enters the bellZone area\n    WA.room.area.onEnter(\"bellZone\").subscribe(() => {\n        name = WA.player.name;\n        // Display the action message\n        actionMessage = WA.ui.displayActionMessage({\n            type: \"message\",\n            message: \"Press SPACE to ring the bell\",\n            callback: () => {\n                // When space is pressed, we send a \"bell-rang\" signal to everyone on the map.\n                WA.event.broadcast(\"bell-rang\", `${name}` );\n            }\n        });\n    });\n\n    // When someone leaves the bellZone area\n    WA.room.area.onLeave(\"bellZone\").subscribe(() => {\n        if (actionMessage !== undefined) {\n            // Hide the action message\n            actionMessage.remove();\n            actionMessage = undefined;\n        }\n    });\n\n    \n        \n\n\nWA.onInit().then(() => {\n    const bellSound = WA.sound.loadSound(\"./error2.wav\");\n    WA.event.on(\"bell-rang\").subscribe(async (eventData: { data?: unknown; senderId?: number; name: string }) => {\n        bellSound.play({});\n        WA.ui.banner.openBanner({\n            id: \"bellNotification\",\n            text: `${eventData.data} has rang the bell!`,\n            bgColor: \"#ffcc00\",\n            textColor: \"#000000\",\n            closable: true,\n\n        });\n    });\n});\n\n}).catch(e => console.error(e));\n\nexport {};\n"],"names":["currentPopup","today","time","closePopup","bootstrapExtra","e","updateTitle","text","color","newTitle","website","x","y","moving","material","checkPlayerMaterial","_b","mySound","_c","playRandomSound","_a","actionMessage","name","bellSound","eventData"],"mappings":"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"}