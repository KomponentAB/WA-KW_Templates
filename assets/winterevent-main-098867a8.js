import{b as P,P as W}from"./init-45730ad6.js";import{c as b,m as u,p as x}from"./footstep-27b9ed04.js";console.log("Script started successfully");let f;WA.onInit().then(()=>{console.log("Scripting API ready"),console.log("Player tags: ",WA.player.tags),WA.room.area.onEnter("clock").subscribe(()=>{const o=new Date,p=o.getHours()+":"+o.getMinutes();f=WA.ui.openPopup("clockPopup","It's "+p,[])}),WA.room.area.onLeave("clock").subscribe(M),P().then(()=>{console.log("Scripting API Extra ready")}).catch(o=>console.error(o)),WA.onInit().then(()=>{WA.room.area.onEnter("inside").subscribe(()=>{WA.room.hideLayer("hide/inside"),WA.room.showLayer("hide/outside")}),WA.room.area.onEnter("outside").subscribe(()=>{WA.room.hideLayer("hide/outside"),WA.room.showLayer("hide/inside")})}).catch(o=>console.error(o))}).catch(o=>console.error(o));function M(){f!==void 0&&(f.close(),f=void 0)}WA.onInit().then(()=>{const o=()=>{let i=!1;return WA.player.onPlayerMove(async({moving:e})=>{if(!e||i)return;i=!0,WA.controls.disablePlayerControls();const n=1200,r=1800,l=800,s=1200,a=Math.random()*(r-n)+n,g=Math.random()*(s-l)+l;console.log(`Moving to random position: x=${a}, y=${g}`),WA.player.moveTo(a,g,30).then(({})=>{WA.controls.restorePlayerControls(),i=!1})})};let p;WA.room.area.onEnter("ice").subscribe(()=>{console.log("enter"),p=o()}),WA.room.area.onLeave("ice").subscribe(()=>{console.log("leave"),p.unsubscribe()})}).catch(o=>console.error(o));WA.onInit().then(()=>{console.log("WA.onInit called"),WA.room.getTiledMap().then(o=>{console.log("Tiled map retrieved");const i=new W(o.properties).getString("collisionLayerName")||"collisions",e=o.layers.find(n=>n.name===i);if(e&&e.type==="tilelayer"){const n=e.data,r=e.width,l=e.height;for(let s=0;s<l;s++)for(let a=0;a<r;a++){const g=s*r+a;n[g]!==0&&console.log(`Tile at (${a}, ${s})`)}}else console.error("Collision layer not found or is not a tile layer")}).catch(o=>console.error("Error retrieving tiled map:",o))}).catch(o=>console.error("Error during WA.onInit:",o));async function I(){const o=await WA.room.getTiledMap();console.log("Room Height: ",o.height),console.log("Room Width: ",o.width);const i=new W(o.properties).getString("collisionLayerName")||"collisions",e=o.layers.find(t=>t.name===i);if(!e||e.type!=="tilelayer"){console.error("Collision layer not found or is not a tile layer");return}const n=e.data,r=e.width,l=e.height,s=[];for(let t=0;t<l;t++)for(let c=0;c<r;c++){const d=t*r+c;n[d]===0&&s.push({x:c,y:t})}const a=8,g=10,y=[];for(let t=0;t<g;t++){const c=Math.floor(Math.random()*s.length),{x:d,y:h}=s.splice(c,1)[0],m=`gift_${Math.floor(Math.random()*a)+1}`;y.push({x:d,y:h,tile:m,layer:"gifts"})}WA.room.setTiles(y),console.log("Gifts placed:",y),WA.room.onEnterLayer("gifts").subscribe(async()=>{console.log("Player entered gifts layer");const{x:t,y:c}=await WA.player.getPosition();console.log("Player position in pixels:",{x:t,y:c});const d=Math.floor(t/32),h=Math.floor(c/32);console.log("Player position in tiles:",{tileX:d,tileY:h});const m=y.findIndex(A=>A.x===d&&A.y===h);m!==-1?(console.log("Gift found at player position"),WA.chat.sendChatMessage("You found a gift!","Game"),WA.room.setTiles([{x:d,y:h,tile:null,layer:"gifts"}]),y.splice(m,1)):console.log("No gift at player position")})}I().catch(o=>console.error("Error populating gifts:",o));WA.onInit().then(async()=>{WA.player.onPlayerMove(async({x:o,y:p,moving:i})=>{var n,r,l;const e=await b({x:o,y:p});return console.log(e),e?!i&&!e?(r=u)==null?void 0:r.stop():((l=u)==null||l.stop(),x(e)):(n=u)==null?void 0:n.stop()})});
//# sourceMappingURL=winterevent-main-098867a8.js.map
